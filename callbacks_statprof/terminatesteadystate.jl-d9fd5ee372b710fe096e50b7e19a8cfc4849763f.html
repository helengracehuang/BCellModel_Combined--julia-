<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - /Users/helenhuang/.julia/packages/DiffEqCallbacks/ci89q/src/terminatesteadystate.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Tue, 28 Jun 2022 17:19:23
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Default test function</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Terminate when all derivatives fall below a threshold or</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              142 &#40;1 &#37;&#41;
              samples spent in allDerivPass
              <br />
              50 &#40;35 &#37;&#41; &#40;ex.&#41;,
              142 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #55
              <a href='terminatesteadystate.jl-d9fd5ee372b710fe096e50b7e19a8cfc4849763f.html#L37'>line 37</a>
              <br />
            </div>
            
            <span class='code'>#   when derivatives are smaller than a fraction of state</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'>69 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>69 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>function allDerivPass&#40;integrator, abstol, reltol, min_t&#41;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if DiffEqBase.isinplace&#40;integrator.sol.prob&#41;</span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='integrator_interface.jl-ffc5d5c7b1d5880f20bd8bd18914c9a181584e5c.html#L90'>get_tmp_cache</a>
              <br />
            </div>
            <span class='code'>        testval &#61; first&#40;get_tmp_cache&#40;integrator&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>45 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              45 &#40;100 &#37;&#41;
              samples spent calling
              <a href='integrator_interface.jl-ffc5d5c7b1d5880f20bd8bd18914c9a181584e5c.html#L82'>get_du&#33;</a>
              <br />
            </div>
            <span class='code'>        DiffEqBase.get_du&#33;&#40;testval, integrator&#41;</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if typeof&#40;integrator.sol.prob&#41; &lt;: DiffEqBase.DiscreteProblem</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            @. testval &#61;  testval - integrator.u</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        testval &#61; get_du&#40;integrator&#41;</span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if typeof&#40;integrator.sol.prob&#41; &lt;: DiffEqBase.DiscreteProblem</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            testval &#61;  testval - integrator.u</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if typeof&#40;integrator.u&#41; &lt;: Array</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'>7 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>52 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              45 &#40;100 &#37;&#41;
              samples spent calling
              <a href='reduce.jl-66096a51b795ad6402e9534e6f023efa3d97869d.html#L1031'>any</a>
              <br />
            </div>
            <span class='code'>        any&#40;abs&#40;d&#41; &gt; abstol &amp;&amp; abs&#40;d&#41; &gt; reltol*abs&#40;u&#41; for &#40;d,abstol, reltol, u&#41; &#61;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>           zip&#40;testval, Iterators.cycle&#40;abstol&#41;, Iterators.cycle&#40;reltol&#41;, integrator.u&#41;&#41; &amp;&amp; &#40;return false&#41;</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        any&#40;&#40;abs.&#40;testval&#41; .&gt; abstol&#41; .&amp; &#40;abs.&#40;testval&#41; .&gt; reltol .* abs.&#40;integrator.u&#41;&#41;&#41; &amp;&amp; &#40;return false&#41;</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if min_t &#61;&#61;&#61; nothing</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return true</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return integrator.t &gt;&#61; min_t</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Allow user-defined tolerances and test functions but use sensible defaults</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># test function must take integrator, time, followed by absolute</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>#   and relative tolerance and return true/false</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function TerminateSteadyState&#40;abstol &#61; 1e-8, reltol &#61; 1e-6, test &#61; allDerivPass;</span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                              min_t &#61; nothing&#41;</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'>4 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>146 &#40;1 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              146 &#40;1 &#37;&#41;
              samples spent in #55
              <br />
              4 &#40;3 &#37;&#41; &#40;ex.&#41;,
              146 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from apply_discrete_callback&#33;
              <a href='callbacks.jl-9d8038a7c04470f1a91b3239094667617e2dfa1f.html#L537'>line 537</a>
              <br />
            </div>
            <div class='callees'>
              142 &#40;100 &#37;&#41;
              samples spent calling
              <a href='terminatesteadystate.jl-d9fd5ee372b710fe096e50b7e19a8cfc4849763f.html#L3'>allDerivPass</a>
              <br />
            </div>
            <span class='code'>    condition &#61; &#40;u, t, integrator&#41; -&gt; test&#40;integrator, abstol, reltol, min_t&#41;</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    affect&#33; &#61; &#40;integrator&#41; -&gt; terminate&#33;&#40;integrator&#41;</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    DiscreteCallback&#40;condition, affect&#33;; save_positions &#61; &#40;true, false&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>export TerminateSteadyState</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

